# JavaSour 各業者測試(此測試範圍較大，需完善測試所有功能)

## 調整內容，測試案例
* 更版程式都在 .38 上
```
Dear Arno
請參考中華JavaSour的調整，修改遠傳及台哥JavaSour，並更新到開發環境上。

git@gitlab01.mitake.com.tw:SMS/smsour/cht/SMSourServiceImpl_CHT.git
branch:shortcode_phase1

Dear 俊宏、Arno
        調整完成後，請協助列完整測試案例進行簡碼測試，

        請使用富邦人壽FBILFE測試，路由及特碼相關設定已設定好，

        短訊、長訊、Unicode、即時、預約、一二階備援等等，都要測試，

        目前備援邏輯是：

        中華簡碼->遠傳長碼
        遠傳簡碼->中華長碼
        台哥簡碼->中華長碼
        
 補充一下，測試範圍包含GW端及中心端統計，確認統計的種類及數字是否正常
```

## 測試流程
* 先上.34找 C:\SMS\FBLIFE(此為舊版API)，確認 gw [ip:port]、[DB:FBILFE] 
* 參考舊版API發送文件
![img.png](Image/img.png)

## 測試前準備
* This test using DB.FBLIFE，API tools use JMeter(FBLIFE_Old_API.jmx)
* SendAccount 
  * FBILFE.SMUser
  * UserName: jtest
  * pw: 12345
  * GroupID: FBLIFE
1. First to find [GroupID] in DBexp.SMGroupRoute，and then find [UserName](Remember [Route])，if not find can create one UserName。
2. Second to find [Route] in DBexp.SMRoute，there are corresponding(對應的) [Mid] and [MobileNo] here。
3. Check this test the Sour Mock(電信業者模擬端) Conf、[PartKey]，and go find DBexp.MidSMSourConfig have corresponding(對應的) [PartKey]，if not find can create。

## API發送檢查流程，各業者都一樣(除了一階、二階失敗不同)
* SmSend API -> http://10.99.0.34:4080/SmSendGet.asp
* LmSend API -> http://10.99.0.34:7006/SpLmGet
* UnSend(Unicode) API -> http://10.99.0.34:7006/SpSendUtf
* Find DBexp.SMRoute the [Note] is your Sour。
1. After send response can see [msgid]，and take to the FBLIFE.MsgInfo find SerialNo=[msgid]。
2. FBLIFE.MsgInfo can see [OrderID(中心序號)]，and take to the DBexp.FBLIFE find SerialNo=[OrderID(中心序號)]。
3. If use [OrderTime(預約時間)]，but DBexp.FBLIFE can't find。
    1. Go to DBexp.LMOrder to update [OrderTime]，need before now。
    2. And go back to DBexp.FBLIFE can see the data。
    
## FET(遠傳)
1. The Phase1 error test Directions (一階失敗測試說明)
   1. Go to remote .38 find the ```JAVA_AP/SMSourFET_2000/target/classes/System_Service.cfgBean.xml``` 
   2. open xml can find pushFailRate this is Phase1 process。
   3. [Mock mode] pushFailRate，0:success、1:fail
2. The Phase2 erroe test Directions (二階失敗測試說明)
   1. Go to remote .38 find the ```JAVA_AP/SMSourFET_2000/conf```
      1. check this conf like code      
      ```
      ### FET API settings
      fet.api.push.primary.url = http://10.99.0.38:6500/mpushapi/smssubmit
      fet.api.push.secondary.url = http://10.99.0.38:6500/mpushapi/smssubmit

      fet.api.retrievedr.primary.url = http://10.99.0.38:6500/drsiweb/smsretrievedr
      fet.api.retrievedr.secondary.url = http://10.99.0.38:6500/drsiweb/smsretrievedr

      fet.api.smsquerydr.primary.url = http://10.99.0.38:6500/drsiweb/smsquerydr
      fet.api.smsquerydr.secondary.url = http://10.99.0.38:6500/drsiweb/smsquerydr
      ```
      2. Find two folder remote .38，need to check url 
         1. ```\JAVA_AP\FET_Test_Server\target\classes\System_Camel.cfgBean.xml```
         2. ```\JAVA_AP\FET_Test_Server_New\target\classes\System_Camel.cfgBean.xml```
      3. Open ```System_Service.cfgBean.xml``` can see [sendScRate(Phase1)] or [sendScRate(Phase2)]
      4. Now you can test，and go to SMDR.SMRedoNowLog to see data、[Phase]。//todo I try but not see data ??

## TAI(台哥)
1. TAI hava some special(特別的) test。
   EX. ``` 短or長orUn簡訊中心端發送失敗 P9 台哥發送簡訊內容不得含有攜碼```
   * This test only send [攜碼] in Param(smbody)。
   * And check FBLIFE.MsgInfo data [MID] not like T%。
   ![img_1.png](Image/攜碼範例圖.png)
2. The Phase1 error test Directions (一階失敗測試說明)
    
3. The Phase2 erroe test Directions (二階失敗測試說明)